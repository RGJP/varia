<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serendipity Yoga üïâÔ∏è</title>
    <script src="https://js.puter.com/v2/"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ------------------- */
        /* --- Global Styles & Variables --- */
        /* ------------------- */
        :root {
            --color-background: #F8F5F2;
            --color-text-primary: #3D405B;
            --color-text-secondary: #5c6081;
            --color-primary-accent: #E07A5F; /* Terracotta orange */
            --color-primary-accent-dark: #c9684c; /* Darker orange */
            --color-secondary-accent: #E9C46A; /* Saffron/gold */
            --color-card-background: #FFFFFF;
            --color-border: #ddd;
            --color-input-background: #fff;
            --color-footer-border: #e0e0e0;
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --font-family-main: 'Inter', sans-serif;
        }
        
        html.dark-theme {
            --color-background: #1A1A2E;
            --color-text-primary: #EAEAEA;
            --color-text-secondary: #a7a9be;
            --color-card-background: #162447;
            --color-border: #4a4a6a;
            --color-input-background: #1f4068;
            --color-footer-border: #3a3a5a;
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.2);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: var(--font-family-main);
            background-color: var(--color-background);
            color: var(--color-text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        body.overlay-open {
            overflow: hidden; /* Prevent scrolling when overlay is open */
        }

        .container {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* ------------------- */
        /* --- Theme Toggle --- */
        /* ------------------- */
        .theme-switch-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem; /* Space between toggler and title */
        }

        .theme-label {
             font-weight: 500;
             font-size: 1.1rem;
             color: var(--color-text-secondary);
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 4px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--color-primary-accent);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }
        
        .sun-icon, .moon-icon {
            font-size: 14px;
        }

        .moon-icon {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .sun-icon {
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        html.dark-theme .moon-icon { opacity: 1; }
        html.dark-theme .sun-icon { opacity: 0; }


        /* ------------------- */
        /* --- Header & Typography --- */
        /* ------------------- */
        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2.5rem;
            animation: fadeInDown 0.8s ease-out;
            padding-top: 2rem;
        }

        h1 {
            font-size: 2.25rem;
            font-weight: 700;
            letter-spacing: -1px;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        
        h1 .logo-highlight {
            color: var(--color-primary-accent);
        }

        .about-button {
            display: inline-block;
            background-color: transparent;
            color: var(--color-text-secondary);
            border: 1px solid var(--color-border);
            padding: 0.5rem 1.25rem;
            border-radius: 20px;
            cursor: pointer;
            font-family: var(--font-family-main);
            font-size: 0.9rem;
            font-weight: 500;
            margin-top: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .about-button:hover {
            background-color: var(--color-primary-accent);
            border-color: var(--color-primary-accent);
            color: white;
            text-decoration: none;
        }

        /* ------------------- */
        /* --- Controls Section (Mobile-First) --- */
        /* ------------------- */
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-bottom: 3rem;
            padding: 1.5rem;
            background-color: var(--color-card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            animation: fadeInUp 0.8s 0.2s ease-out backwards;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
        }

        .control-group label {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--color-text-primary);
            text-align: center;
        }

        .pose-count-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            justify-content: center;
        }

        .pose-count-btn {
            flex-grow: 1;
            flex-basis: calc(25% - 1rem);
            max-width: 70px;
            height: 60px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-primary-accent);
            background-color: var(--color-input-background);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pose-count-btn:hover {
            border-color: var(--color-primary-accent);
            transform: translateY(-2px);
        }

        .pose-count-btn.active {
            background-color: var(--color-primary-accent);
            border-color: var(--color-primary-accent);
            color: white;
            transform: translateY(0);
        }

        /* ------------------- */
        /* --- Session Display & Pose Cards --- */
        /* ------------------- */
        .session-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .pose-card, .controls {
            transition: background-color 0.3s ease;
        }

        .pose-card {
            background-color: var(--color-card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s ease;
            animation: popIn 0.5s ease-out forwards;
        }
        
        .pose-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
        }
        html.dark-theme .pose-card:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
        }

        .card-image-container {
            position: relative;
            width: 100%;
            height: 200px;
            background-color: rgba(0,0,0,0.05);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        html.dark-theme .card-image-container {
             background-color: rgba(255,255,255,0.05);
        }

        .pose-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: opacity 0.5s ease-in-out;
            cursor: pointer;
        }
        
        .pose-name {
            font-size: 1.1rem;
            font-weight: 600;
            padding: 1rem 1.25rem;
            text-align: center;
            text-transform: capitalize;
        }
        
        /* ------------------- */
        /* --- Image Overlay --- */
        /* ------------------- */
        .image-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .image-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .image-overlay img {
            max-width: 90vw;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
            animation: zoomIn 0.3s ease-out;
        }

        /* ------------------- */
        /* --- About Overlay --- */
        /* ------------------- */
        .about-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            padding: 1rem;
        }

        .about-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .about-content {
            background-color: var(--color-card-background);
            padding: 2rem;
            border-radius: var(--border-radius);
            max-width: 600px;
            width: 100%;
            box-shadow: var(--shadow-medium);
            cursor: default;
            animation: popIn 0.4s ease-out;
            color: var(--color-text-secondary);
            line-height: 1.7;
        }

        .about-content p {
            font-size: 1rem;
        }

        /* ------------------- */
        /* --- General Animations --- */
        /* ------------------- */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); }
            to { transform: scale(1); }
        }
        
        /* ------------------- */
        /* --- Footer --- */
        /* ------------------- */
        footer {
            text-align: center;
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--color-footer-border);
            color: var(--color-text-secondary);
            font-size: 0.9rem;
            animation: fadeInUp 0.8s 0.4s ease-out backwards;
            transition: border-color 0.3s ease;
        }
        
        footer p {
            margin-bottom: 1rem;
        }
        
        footer a {
            color: var(--color-primary-accent);
            text-decoration: none;
            font-weight: 500;
        }

        footer a:not(.about-button):hover {
            text-decoration: underline;
        }

        /* ------------------- */
        /* --- Responsive Design --- */
        /* ------------------- */
        @media (min-width: 600px) {
            .container {
                padding: 2rem 1.5rem;
            }

            .header {
                padding-top: 0;
            }

            .controls {
                justify-content: center;
                align-items: center;
            }

            .control-group {
                align-items: center;
                gap: 1rem;
                width: auto;
            }

            .pose-count-buttons {
                max-width: 450px;
            }

            .session-grid {
                gap: 2rem;
            }
        }

        @media (min-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
    <script>
        // IIFE to set theme instantly, preventing FOUC
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.documentElement.classList.add('dark-theme');
            }
        })();
    </script>
</head>
<body>
    <div class="container">
        
        <header>
            <div class="theme-switch-container">
                <span class="theme-label">üåì</span>
                <label class="theme-switch" for="theme-toggle" title="Toggle theme">
                    <input type="checkbox" id="theme-toggle" />
                    <div class="slider">
                        <span class="sun-icon"></span>
                        <span class="moon-icon"></span>
                    </div>
                </label>
            </div>
            <h1> Serendipity<span class="logo-highlight"> Yoga üïâÔ∏è</span></h1>
            <button id="about-btn" class="about-button">About ‚ÑπÔ∏è</button>
        </header>

        <main>
            <section class="controls">
                <div class="control-group">
                    <label>How many poses?</label>
                    <div class="pose-count-buttons" id="pose-count-buttons">
                        <button type="button" class="pose-count-btn" data-value="3">3</button>
                        <button type="button" class="pose-count-btn" data-value="5">5</button>
                        <button type="button" class="pose-count-btn" data-value="7">7</button>
                        <button type="button" class="pose-count-btn" data-value="9">9</button>
                        <button type="button" class="pose-count-btn" data-value="11">11</button>
                        <button type="button" class="pose-count-btn" data-value="13">13</button>
                        <button type="button" class="pose-count-btn" data-value="15">15</button>
                        <button type="button" class="pose-count-btn" data-value="17">17</button>
                        <button type="button" class="pose-count-btn" data-value="19">19</button>
                        <button type="button" class="pose-count-btn" data-value="21">21</button>
                        <button type="button" class="pose-count-btn" data-value="23">23</button>
                        <button type="button" class="pose-count-btn" data-value="25">25</button>
                    </div>
                    <input type="hidden" id="pose-count-value" value="">
                </div>
            </section>

            <section id="session-display" class="session-grid">
            </section>
        </main>

        <footer>
            <p>
                Created with love for well-being. Images are sourced from freely available public content via Google, and are used solely for the purpose of illustrating the poses üôè
            </p>
            <a href="mailto:raffael.jomphe@gmail.com" class="about-button">Contact üìß</a>
        </footer>
    </div>

    <div id="image-overlay" class="image-overlay">
        <img id="overlay-img" src="" alt="Enlarged yoga pose">
    </div>

    <div id="about-overlay" class="about-overlay">
        <div class="about-content">
            <p>"Serendipity Yoga" is a minimalistic random yoga session generator designed to bring variety and playfulness to your practice. Simply choose how many poses you'd like, breathe deeply, and enjoy exploring the sequence.<br><br> This tool celebrates the spirit of serendipity‚Äîfinding joy in the unexpected‚Äîso the sequences may obviously sometimes be too challenging or not suited to your personal needs or physical limitations. You can regenerate them as often as you like to discover new or better combinations.<br><br> Think of it as an exploration tool, offering endless unique sessions drawn from a curated library of nearly 200 (and growing) yoga poses and a few sequences. Enjoy your practice, stay curious, and above all, remember to listen to your body.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ------------------- //
            // --- THEME TOGGLE LOGIC --- //
            // ------------------- //
            const themeToggle = document.getElementById('theme-toggle');
            const htmlElement = document.documentElement;

            if (htmlElement.classList.contains('dark-theme')) {
                themeToggle.checked = true;
            }

            themeToggle.addEventListener('change', () => {
                if (themeToggle.checked) {
                    htmlElement.classList.add('dark-theme');
                    localStorage.setItem('theme', 'dark');
                } else {
                    htmlElement.classList.remove('dark-theme');
                    localStorage.setItem('theme', 'light');
                }
            });

            // ------------------- //
            // --- LOCAL IMAGE DATABASE --- //
            // ------------------- //
            const localImageFiles = [
                'yogaposes/accomplished.jpg', 'yogaposes/auspicious.jpg', 'yogaposes/awkward.jpg',
                'yogaposes/baby cobra.jpg', 'yogaposes/balancing table .jpg', 'yogaposes/bananasana side bend.jpg',
                'yogaposes/beam .jpg', 'yogaposes/beginner vinyasa flow.jpg', 'yogaposes/bharadvaja twist.jpg',
                'yogaposes/big toe.jpg', 'yogaposes/bird of paradise.jpg', 'yogaposes/boat.jpg',
                'yogaposes/bound angle.jpg', 'yogaposes/bow.jpg', 'yogaposes/bridge.jpg',
                'yogaposes/butterfly.jpg', 'yogaposes/cat cow.jpg', 'yogaposes/cat pulling its tail.jpg',
                'yogaposes/caterpillar.jpg', 'yogaposes/chair.jpg', 'yogaposes/child .jpg', 'yogaposes/cobra.jpg',
                'yogaposes/corpse .jpg', 'yogaposes/cow face.jpg', 'yogaposes/cow.jpg', 'yogaposes/crane.jpg',
                'yogaposes/crescent lunge.jpg', 'yogaposes/crocodile.jpg', 'yogaposes/crow crane.jpg',
                'yogaposes/cycling.jpg', 'yogaposes/dancer.jpg', 'yogaposes/dancing shiva.jpg',
                'yogaposes/dangling.jpg', 'yogaposes/deer .jpg', 'yogaposes/dolphin plank.jpg',
                'yogaposes/dolphin.jpg', 'yogaposes/downward dog.jpg', 'yogaposes/dragon.jpg',
                'yogaposes/dragonfly.jpg', 'yogaposes/eagle.jpg', 'yogaposes/easy .jpg',
                'yogaposes/extended hand to big toe.jpg', 'yogaposes/extended side angle.jpg',
                'yogaposes/fallen triangle.jpg', 'yogaposes/fire log.jpg', 'yogaposes/firefly.jpg',
                'yogaposes/fish.jpg', 'yogaposes/five pointed star.jpg', 'yogaposes/forearm plank.jpg',
                'yogaposes/full locust.jpg', 'yogaposes/garland.jpg', 'yogaposes/goddess.jpg',
                'yogaposes/gorilla.jpg', 'yogaposes/half boat.jpg', 'yogaposes/half butterfly.jpg',
                'yogaposes/half frog.jpg', 'yogaposes/half moon.jpg', 'yogaposes/half split.jpg',
                'yogaposes/half standing forward bend.jpg', 'yogaposes/hamstrings sequence.jpg',
                'yogaposes/happy baby.jpg', 'yogaposes/head to knee forward bend.jpg', 'yogaposes/head to knee.jpg',
                'yogaposes/headstand.jpg', 'yogaposes/hero.jpg', 'yogaposes/heron.jpg', 'yogaposes/high lunge.jpg',
                'yogaposes/horse.jpg', 'yogaposes/humble warrior.jpg', 'yogaposes/king cobra.jpg',
                'yogaposes/lizard.jpg', 'yogaposes/locust.jpg', 'yogaposes/low lunge.jpg', 'yogaposes/lunge.jpg',
                'yogaposes/lying spinal twist.jpg', 'yogaposes/marichi.jpg',
                'yogaposes/mermaid.jpg', 'yogaposes/monkey.jpg', 'yogaposes/moon salutation.jpg',
                'yogaposes/mountain.jpg', 'yogaposes/nataraj.jpg', 'yogaposes/neck rolls.jpg',
                'yogaposes/one leg bridge.jpg', 'yogaposes/one leg king pigeon.jpg', 'yogaposes/one leg plank.jpg',
                'yogaposes/one leg seated forward bend.jpg', 'yogaposes/one leg wheel.jpg',
                'yogaposes/one legged mountain.jpg', 'yogaposes/palm tree.jpg', 'yogaposes/peacock.jpg',
                'yogaposes/pendant.jpg', 'yogaposes/plow.jpg', 'yogaposes/prone savasana.jpg',
                'yogaposes/puppy.jpg', 'yogaposes/pyramid.jpg', 'yogaposes/rabbit.jpg',
                'yogaposes/reclined bound angle.jpg', 'yogaposes/reclining hand to toe.jpg',
                'yogaposes/reclining hero.jpg', 'yogaposes/reclining staff.jpg', 'yogaposes/reverse table top.jpg',
                'yogaposes/reverse warrior.jpg', 'yogaposes/Revolved Bound Angle Pose.jpg',
                'yogaposes/revolved chair.jpg', 'yogaposes/revolved half moon.jpg',
                'yogaposes/revolved hand to big toe.jpg', 'yogaposes/revolved head to knee.jpg',
                'yogaposes/revolved lunge.jpg', 'yogaposes/revolved triangle.jpg',
                'yogaposes/Revolved Wide-Legged Forward Bend.jpg', 'yogaposes/rocking baby.jpg',
                'yogaposes/saddle.jpg', 'yogaposes/scale.jpg', 'yogaposes/seated forward bend.jpg',
                'yogaposes/seated spinal twist.jpg', 'yogaposes/seated twist simple.jpg',
                'yogaposes/seated twist.jpg', 'yogaposes/shoulder rolls.jpg', 'yogaposes/shoulder stand.jpg',
                'yogaposes/side lunge.jpg', 'yogaposes/side plank three legs.jpg', 'yogaposes/side plank.jpg',
                'yogaposes/sleeping swan.jpg', 'yogaposes/sleeping vishnu.jpg', 'yogaposes/snail.jpg',
                'yogaposes/sphinx.jpg', 'yogaposes/staff .jpg', 'yogaposes/standing forward bend.jpg',
                'yogaposes/standing pigeon.jpg', 'yogaposes/standing side bend.jpg',
                'yogaposes/standing split.jpg', 'yogaposes/standing strong sequence.jpg',
                'yogaposes/sugarcane.jpg', 'yogaposes/sun salutation.jpg', 'yogaposes/superman.jpg',
                'yogaposes/swan .jpg', 'yogaposes/table top.jpg', 'yogaposes/thread the needle.jpg',
                'yogaposes/three legged downward dog.jpg', 'yogaposes/thunderbolt.jpg', 'yogaposes/tiger.jpg',
                'yogaposes/tiptoe .jpg', 'yogaposes/tree.jpg', 'yogaposes/triangle.jpg',
                'yogaposes/twisted roots.jpg', 'yogaposes/universal spinal twist.jpg',
                'yogaposes/Upward Extended Feet lifts.jpg', 'yogaposes/upward facing dog.jpg',
                'yogaposes/upward facing seated.jpg', 'yogaposes/upward plank.jpg',
                'yogaposes/upward salute.jpg', 'yogaposes/vamadeva.jpg', 'yogaposes/wall squat.jpg',
                'yogaposes/warrior i.jpg', 'yogaposes/warrior ii.jpg', 'yogaposes/warrior iii.jpg',
                'yogaposes/wheel .jpg', 'yogaposes/wide angle seated bend.jpg', 'yogaposes/wild thing.jpg',
                'yogaposes/wind relieving.jpg', 'yogaposes/yin yoga sequence.jpg'
            ];

            // ------------------- //
            // --- DOM ELEMENTS --- //
            // ------------------- //
            const sessionDisplay = document.getElementById('session-display');
            const poseCountButtonsContainer = document.getElementById('pose-count-buttons');
            const poseCountValueInput = document.getElementById('pose-count-value');
            const imageOverlay = document.getElementById('image-overlay');
            const overlayImg = document.getElementById('overlay-img');
            const aboutBtn = document.getElementById('about-btn');
            const aboutOverlay = document.getElementById('about-overlay');
            const aboutContent = document.querySelector('.about-content');

            // ------------------- //
            // --- EVENT LISTENERS --- //
            // ------------------- //
            poseCountButtonsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('pose-count-btn')) {
                    const selectedValue = e.target.dataset.value;
                    poseCountValueInput.value = selectedValue;
                    poseCountButtonsContainer.querySelector('.pose-count-btn.active')?.classList.remove('active');
                    e.target.classList.add('active');
                    generateSession();
                }
            });
            
            // Event delegation for opening the image overlay
            sessionDisplay.addEventListener('click', (e) => {
                if (e.target.classList.contains('pose-image')) {
                    overlayImg.src = e.target.src;
                    imageOverlay.classList.add('show');
                    document.body.classList.add('overlay-open');
                }
            });

            // Event listener for closing the image overlay
            imageOverlay.addEventListener('click', () => {
                imageOverlay.classList.remove('show');
                document.body.classList.remove('overlay-open');
            });

            // --- About Overlay Listeners ---
            aboutBtn.addEventListener('click', () => {
                aboutOverlay.classList.add('show');
                document.body.classList.add('overlay-open');
            });

            aboutOverlay.addEventListener('click', () => {
                aboutOverlay.classList.remove('show');
                document.body.classList.remove('overlay-open');
            });

            // Prevent overlay from closing when clicking inside the content box
            aboutContent.addEventListener('click', (e) => {
                e.stopPropagation();
            });


            // ------------------- //
            // --- CORE FUNCTIONS --- //
            // ------------------- //

            function generateSession() {
                const poseCount = parseInt(poseCountValueInput.value);
                if (isNaN(poseCount) || poseCount <= 0) return; // Don't generate if count is invalid

                sessionDisplay.innerHTML = ''; // Clear the display

                // Fisher-Yates shuffle for a truly random sequence
                const shuffledFiles = [...localImageFiles];
                for (let i = shuffledFiles.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffledFiles[i], shuffledFiles[j]] = [shuffledFiles[j], shuffledFiles[i]];
                }

                const selectedFiles = shuffledFiles.slice(0, poseCount);

                selectedFiles.forEach((filePath, index) => {
                    const card = createPoseCard(filePath, index);
                    sessionDisplay.appendChild(card);
                });
            }
            
            function createPoseCard(filePath, index) {
                const card = document.createElement('article');
                card.className = 'pose-card';
                card.style.animationDelay = `${index * 100}ms`;

                // Extract name from file path (e.g., "yogaposes/cat cow.jpg" -> "cat cow")
                const fileName = filePath.split('/').pop();
                const poseName = fileName.substring(0, fileName.lastIndexOf('.'));

                // Create card structure
                const imageContainer = document.createElement('div');
                imageContainer.className = 'card-image-container';

                const img = document.createElement('img');
                img.src = filePath;
                img.alt = poseName;
                img.loading = 'lazy';
                img.className = 'pose-image';
                imageContainer.appendChild(img);
                
                const nameHeader = document.createElement('h3');
                nameHeader.className = 'pose-name';
                nameHeader.textContent = poseName;

                card.appendChild(imageContainer);
                card.appendChild(nameHeader);
                
                return card;
            }

            // ------------------- //
            // --- INITIALIZATION --- //
            // ------------------- //
            
            // No initialization needed; session generation is now user-triggered.

        });
    </script>
</body>
</html>